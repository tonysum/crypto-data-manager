# 如何确认数据已成功自动更新？

您可以通过以下三种方式来检查“快递员”是否按时送货，以及“货架”上的数据是否变新了。

## 1. 生活中的类比：检查报纸投递
这就像您订了一份每日自动送达的报纸：
- **看监控 (PM2 Logs)**：就像看家门口的监控录像，看看快递员有没有在整点过后推着小车过来。
- **翻记录 (Log File)**：就像查看快递公司的签收存根，每一笔成功的投递都有据可查。
- **看信箱 (Database)**：这是最直接的，打开信箱看看最新的报纸日期是不是今天的。

## 2. 验证流程图 (ASCII)
```text
[ PM2 管理器 ] --(输出状态)--> 1. PM2 实时日志 (pm2 logs)
      |
      +--------(写入)------> 2. 文件日志 (data/scheduler.log)
      |
      V
[ 数据库表 ] --(更新数据)--> 3. 最新记录 (SELECT ... ORDER BY trade_date DESC)
```

## 3. 具体验证步骤

### 第一步：查看 PM2 实时输出 (最直观)
在终端输入以下命令，您可以看到程序每分钟的运行状态：
```bash
pm2 logs crypto-scheduler
```
*   **您将看到**：每到 5 分、15 分或整点时，日志会打印 `🚀 [调度触发] 开始实时更新: 5m` 以及随后的 `✅ [调度完成] 更新成功: 5m`。

### 第二步：查看持久化日志文件
程序会将所有的详细过程记录在 [scheduler.log](file:///Users/tony/Documents/crypto/crypto-data-manager/data/scheduler.log) 中。
您可以在终端使用 `tail` 命令持续观察：
```bash
tail -f data/scheduler.log
```
或者直接在 IDE 中打开该文件查看历史记录。

### 第三步：直接查询数据库 (最终验证)
这是最权威的验证方式。您可以连接 PostgreSQL 数据库并运行以下查询，看看最新的一条数据时间：
```sql
-- 以 BTCUSDT 的 5 分钟线为例
SELECT trade_date FROM "K5mBTCUSDT" ORDER BY trade_date DESC LIMIT 1;
```
如果这个时间在不断推进，说明更新一切正常。

## 4. 关键的“坑” (Gotcha)
**1. 别忘了 15 秒的“礼貌等待”**：
由于我们在脚本中设置了 `OFFSET = 15`，您在整点（比如 12:05:00）刷新数据库是看不到新数据的。请在 **12:05:20** 之后再查看，那时候数据才刚刚抓取并存入。

**2. 数据库表名的大小写引号**：
在手动写 SQL 查询时，表名 `"K5mBTCUSDT"` 必须带**双引号**。因为 PostgreSQL 会把没带引号的大写字母自动转为小写，导致报错“表不存在”。

---
**您想让我为您运行一段测试指令来演示如何查看这些日志吗？**
